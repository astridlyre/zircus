!function(){"use strict";const t=t=>document.getElementById(t),e="https://zircus.herokuapp.com/api";const i=new class{constructor(){const t=localStorage.getItem("state");this.__state=JSON.parse(t)||{},this.__hooks=new Set,this.__notification=null,this.__notify=null}set(t,e){return this.__state[t]=e,this.save()}save(){return localStorage.setItem("state",JSON.stringify(this.__state)),this}get hooks(){return this.__hooks||{}}addHook(t){return this.__hooks.add(t),this}get inv(){return this.__state.inv||[]}set inv(t){return this.set("inv",t(this.inv)).update("inv")}get countries(){return this.__state.countries||[]}set countries(t){return this.set("countries",t(this.countries)).update("countries")}get cart(){return this.__state.cart||[]}set cart(t){return this.set("cart",t(this.cart)).update("cart")}get secret(){return this.__state.secret||null}set secret(t){return this.set("secret",t)}get currentItem(){return this.__state.currentItem||null}set currentItem(t){return this.set("currentItem",t)}get order(){return this.__state.order||null}set order(t){if(!this.__state.order||null==t)return this.set("order",t)}set modal(t){return this.__modal=t,this}get modal(){return this.__modal}setNotify(t){this.__notify=t}notify(t,e,i){return this.__notify(t,e,i)}set currentNotification(t){this.__notification=t}get currentNotification(){return this.__notification}update(t){return this.hooks.forEach((({hook:e,key:i})=>t===i&&e({inv:this.inv,countries:this.countries,cart:this.cart}))),this}};class s{constructor(t,e,i){if(this.e=document.createElement(t),this.children=[],e&&Array.isArray(e)?e.forEach((t=>{this.e.classList.add(t)})):e&&"string"==typeof e&&this.e.classList.add(e),i)for(const[t,e]of Object.entries(i))this.e.setAttribute(t,e)}render(){return this.children.forEach((t=>{t instanceof s?this.e.appendChild(t.render()):this.e.textContent=t})),this.e}event(t,e){return this.e.addEventListener(t,(()=>e())),this}addChild(t){return this.children.push(t),this}}function n(t,e,i,s){const n=(t,e,i)=>{t.classList.remove(e),t.classList.add(i)};return Array.isArray(t)?t.forEach((t=>n(t,e,i))):n(t,e,i),s&&Array.isArray(s)&&s.forEach((t=>t())),t}function a(t,e){Array.isArray(t)?t.forEach((t=>t.textContent=e)):t.textContent=e}function r(t){return document.head.appendChild(new s("link",null,{href:t,rel:"prefetch",as:"image"}).render())}const o=async()=>await fetch(`${e}/inv`).then((t=>t.json())).then((t=>i.inv=()=>[...t.cf,...t.pf,...t.ff])).catch((t=>{console.error("Unable to get inventory",t.message)}));function c(){let t=null;return t||document.documentElement.getAttribute("lang")}function d(t){return t[c()]}o(),setInterval(o,3e5);const u={Canada:{states:[{id:872,name:"Alberta",state_code:"AB"},{id:875,name:"British Columbia",state_code:"BC"},{id:867,name:"Manitoba",state_code:"MB"},{id:868,name:"New Brunswick",state_code:"NB"},{id:877,name:"Newfoundland and Labrador",state_code:"NL"},{id:878,name:"Northwest Territories",state_code:"NT"},{id:874,name:"Nova Scotia",state_code:"NS"},{id:876,name:"Nunavut",state_code:"NU"},{id:866,name:"Ontario",state_code:"ON"},{id:871,name:"Prince Edward Island",state_code:"PE"},{id:873,name:"Quebec",state_code:"QC"},{id:870,name:"Saskatchewan",state_code:"SK"},{id:869,name:"Yukon",state_code:"YT"}]},"United States":{states:[{id:1456,name:"Alabama",state_code:"AL"},{id:1400,name:"Alaska",state_code:"AK"},{id:1424,name:"American Samoa",state_code:"AS"},{id:1434,name:"Arizona",state_code:"AZ"},{id:1444,name:"Arkansas",state_code:"AR"},{id:1402,name:"Baker Island",state_code:"UM-81"},{id:1416,name:"California",state_code:"CA"},{id:1450,name:"Colorado",state_code:"CO"},{id:1435,name:"Connecticut",state_code:"CT"},{id:1399,name:"Delaware",state_code:"DE"},{id:1437,name:"District of Columbia",state_code:"DC"},{id:1436,name:"Florida",state_code:"FL"},{id:1455,name:"Georgia",state_code:"GA"},{id:1412,name:"Guam",state_code:"GU"},{id:1411,name:"Hawaii",state_code:"HI"},{id:1398,name:"Howland Island",state_code:"UM-84"},{id:1460,name:"Idaho",state_code:"ID"},{id:1425,name:"Illinois",state_code:"IL"},{id:1440,name:"Indiana",state_code:"IN"},{id:1459,name:"Iowa",state_code:"IA"},{id:1410,name:"Jarvis Island",state_code:"UM-86"},{id:1428,name:"Johnston Atoll",state_code:"UM-67"},{id:1406,name:"Kansas",state_code:"KS"},{id:1419,name:"Kentucky",state_code:"KY"},{id:1403,name:"Kingman Reef",state_code:"UM-89"},{id:1457,name:"Louisiana",state_code:"LA"},{id:1453,name:"Maine",state_code:"ME"},{id:1401,name:"Maryland",state_code:"MD"},{id:1433,name:"Massachusetts",state_code:"MA"},{id:1426,name:"Michigan",state_code:"MI"},{id:1438,name:"Midway Atoll",state_code:"UM-71"},{id:1420,name:"Minnesota",state_code:"MN"},{id:1430,name:"Mississippi",state_code:"MS"},{id:1451,name:"Missouri",state_code:"MO"},{id:1446,name:"Montana",state_code:"MT"},{id:1439,name:"Navassa Island",state_code:"UM-76"},{id:1408,name:"Nebraska",state_code:"NE"},{id:1458,name:"Nevada",state_code:"NV"},{id:1404,name:"New Hampshire",state_code:"NH"},{id:1417,name:"New Jersey",state_code:"NJ"},{id:1423,name:"New Mexico",state_code:"NM"},{id:1452,name:"New York",state_code:"NY"},{id:1447,name:"North Carolina",state_code:"NC"},{id:1418,name:"North Dakota",state_code:"ND"},{id:1431,name:"Northern Mariana Islands",state_code:"MP"},{id:4851,name:"Ohio",state_code:"OH"},{id:1421,name:"Oklahoma",state_code:"OK"},{id:1415,name:"Oregon",state_code:"OR"},{id:1448,name:"Palmyra Atoll",state_code:"UM-95"},{id:1422,name:"Pennsylvania",state_code:"PA"},{id:1449,name:"Puerto Rico",state_code:"PR"},{id:1461,name:"Rhode Island",state_code:"RI"},{id:1443,name:"South Carolina",state_code:"SC"},{id:1445,name:"South Dakota",state_code:"SD"},{id:1454,name:"Tennessee",state_code:"TN"},{id:1407,name:"Texas",state_code:"TX"},{id:1432,name:"United States Minor Outlying Islands",state_code:"UM"},{id:1413,name:"United States Virgin Islands",state_code:"VI"},{id:1414,name:"Utah",state_code:"UT"},{id:1409,name:"Vermont",state_code:"VT"},{id:1427,name:"Virginia",state_code:"VA"},{id:1405,name:"Wake Island",state_code:"UM-79"},{id:1462,name:"Washington",state_code:"WA"},{id:1429,name:"West Virginia",state_code:"WV"},{id:1441,name:"Wisconsin",state_code:"WI"},{id:1442,name:"Wyoming",state_code:"WY"}]}};i.countries=()=>u;const l={nav:{cartText:{en:"cart",fr:"panier"}},product:{addToCart:{en:["out of stock","add to cart"],fr:["non disponible","ajouter"]},addNotificationText:t=>({en:`Added ${t.name.en} to cart`,fr:`Ajouté des ${t.name.fr} au panier`}),stockText:t=>t>5?{en:"In stock",fr:"En stock"}:t>0?{en:`Only ${t} left!`,fr:`Il n'en reste que ${t}!`}:{en:"None available",fr:"Non disponible"}},cart:{removeNotificationText:t=>({en:`Removed ${t.name.en} from cart`,fr:`${t.name.fr} retiré du panier`}),removeBtnText:t=>({en:`Remove ${t.name.en} (size: ${t.size} quantity: ${t.quantity}) from cart`,fr:`Retirer ${t.name.fr} (taille: ${t.size} quantité: ${t.quantity}) du panier`})},checkout:{formText:{Canada:{en:["Province","Postal Code"],fr:["Province","Code postal"]},"United States":{en:["State","Zip"],fr:["État","Code postal"]}}},contactText:{en:{error:["Error","ok"],default:["Success","ok","Close modal","cancel","Cancel"],message:(t,e)=>`Thanks for your message, ${t}! We'll get back to you at ${e} as soon as possible.`},fr:{error:["Error","ok"],default:["Succès","ok","Fermer la fenêtre contextuelle","annuler","Annuler"],message:(t,e)=>`Merci pour votre message ${t}! Nous vous rappelleons à votre courriel ${e} dans les plus brefs délais.`}},redirect:{en:"Visit our site in English?",fr:"Visitez notre site en Français?"}};function h({productTemplate:t,updateSubtotal:e=null,renderCartProducts:n=null,item:a,withActions:r=!1}){const{removeBtnText:o,removeNotificationText:u}=l.cart;const h=t.content.cloneNode(!0),m=h.querySelector(".cart__product"),p=h.querySelector("a"),f=h.querySelector("img"),y=h.querySelector("p"),g=h.querySelector("span"),_=h.querySelector(".input"),b=h.querySelector("label"),C=h.querySelector("button");return p.href=`/products/${a.name.en.toLowerCase().split(" ").join("-")}${"en"!==c()?`-${c()}`:""}.html`,p.addEventListener("click",(()=>i.currentItem={type:a.type,color:a.color,size:a.size})),p.setAttribute("title",a.name[c()]),f.src=a.images.sm_a,f.alt=`${a.name[c()]} ${a.size} ${a.color} underwear`,r?(y.textContent=`${a.name[c()]} (${a.size})`,g.textContent="$"+a.price*a.quantity,_.value=a.quantity,_.id=a.type,_.setAttribute("name",`${a.name[c()]} ${a.size} ${a.color}`),b.setAttribute("for",a.type),_.addEventListener("input",(()=>{_.value||(_.value=1);const t=i.inv.find((t=>t.type===a.type)).quantity;Number(_.value)>t&&(_.value=t),i.cart=t=>t.map((t=>t.id===a.id?{...t,quantity:Number(_.value)}:t)),g.textContent="$"+a.price*Number(_.value),C.setAttribute("title",d(o({...a,quantity:Number(_.value)}))),e()})),C.setAttribute("title",d(o(a))),C.setAttribute("aria-label",d(o(a))),C.addEventListener("click",(()=>{i.cart=t=>t.filter((t=>t.id!==a.id)),m.remove(),e(),i.notify(function(t,e){const i=new s("img","notification__image",{src:t.images.sm_a,alt:t.name[c()]}),n=new s("a","notification__text",{href:e,title:d({en:"Go to product page",fr:"Aller au page du produit"})}).addChild(d(u(t)));return{content:[i.render(),n.render()],color:"gray"}}(a,p.href)),!i.cart.length&&n()}))):y.textContent=`${a.name[c()]} (${a.size}) x ${a.quantity}`,h}const m=Stripe("pk_test_51J93KzDIzwSFHzdzCZtyRcjMvw8em0bhnMrVmkBHaMFHuc2nkJ156oJGNxuz0G7W4Jx0R6OCy2nBXYTt6U8bSYew00PIAPcntP");const p=/^[A-Za-z][0-9][A-Za-z] ?[0-9][A-Za-z][0-9]$/,f=/^[0-9]{5}(-[0-9]{4})?$/;function y(){const t=l.nav.cartText;return{updateCartLink(e){i.cart.length>0?a(e,`${d(t)} (${i.cart.reduce(((t,e)=>t+e.quantity),0)})`):a(e,d(t))}}}function g(){class t extends HTMLElement{constructor(){super(),this.nav=this.querySelector("#nav"),this.cartLink=this.querySelector("#cart-link"),this.navScrollHandler=((t,e)=>{const i=(e,i,s)=>a=>n(t,e,i,[s,a]),s=i("slide-up","slide-down",(()=>c=!1)),a=i("slide-down","slide-up",(()=>c=!0)),r=()=>o=!1;let o=!1,c=!1,d=!1;return(t=!1)=>{const i=window.scrollY<100||e.next().value<=0;if(t)return s((()=>d=!0));d=!1,o?o=!0:setTimeout((()=>i&&c?s(r):i||c?void 0:a(r)),100)}})(this.nav,t.scrollState()),this.nav.addEventListener("focusin",(()=>this.navScrollHandler(!0))),this.nav.addEventListener("focusout",(()=>this.navScrollHandler(!1))),document.addEventListener("scroll",(()=>{this.navScrollHandler()})),this.updateCartLink([this.cartLink]),i.addHook({hook:()=>this.updateCartLink([this.cartLink]),key:"cart"})}static*scrollState(){let t=0,e=0;for(;;)[t,e]=[e,window.scrollY],yield e-t}}Object.assign(t.prototype,y()),customElements.get("nav-menu")||customElements.define("nav-menu",t)}class _ extends HTMLElement{connectedCallback(){this._heading=this.querySelector("#modal-heading"),this._content=this.querySelector("#modal-content"),this._ok=this.querySelector("#modal-ok"),this._cancel=this.querySelector("#modal-cancel")}hide(){this._cancel.classList.add("hidden"),this._heading.textContent="",this._content.textContent="",this._ok.textContent="",this._cancel.textContent="",this.classList.add("hidden")}attributeChangedCallback(t,e,s){"show"===t&&"true"===s&&this.show(i.modal)}static get observedAttributes(){return["show"]}}function b(t){i.modal=t,document.querySelector("zircus-modal").setAttribute("show","true")}Object.assign(_.prototype,(()=>{const e=t("blur"),n=t("nav"),a=()=>{e.classList.remove("blur"),n.classList.remove("blur"),document.body.classList.remove("hide-y"),document.querySelector("zircus-modal").setAttribute("show","false"),i.modal=null};return{show({heading:t,content:i,ok:r,cancel:o}){e.classList.add("blur"),n.classList.add("blur"),document.body.classList.add("hide-y"),this.classList.remove("hidden"),this._heading.textContent=t,"string"==typeof i?this._content.appendChild(new s("p","modal__text").addChild(i).render()):i instanceof HTMLElement&&this._content.appendChild(i),this._ok.textContent=r.text,this._ok.setAttribute("title",r.title),this._ok.addEventListener("click",(()=>{r.action(a)})),o?(this._cancel.classList.remove("hidden"),this._cancel.textContent=o.text,this._cancel.setAttribute("title",o.title),this._cancel.addEventListener("click",(()=>{o.acton(a)})),this._cancel.focus()):this._ok.focus()}}})()),customElements.get("zircus-modal")||customElements.define("zircus-modal",_);const{contactText:C}=l;!function(){!function(){class t extends HTMLElement{constructor(){super(),this.text=new s("p",["product__inputs_stock","dot"]).render(),this.appendChild(this.text)}connectedCallback(){this.quantity=this.getAttribute("quantity")}inStock(){this.text.classList.add("in-stock"),this.text.classList.remove("out-stock")}outStock(){this.text.classList.add("out-stock"),this.text.classList.remove("in-stock")}attributeChangedCallback(t,e,i){return"text"===t?this.text.textContent=i:"quantity"===t?Number(i)>0?this.inStock():this.outStock():void 0}static get observedAttributes(){return["text"]}}customElements.get("zircus-in-stock-text")||customElements.define("zircus-in-stock-text",t)}(),function(){class e extends HTMLElement{constructor(){super(),this.image=new s("img","product__full__img").render(),this.appendChild(this.image)}setImage(){this.image.src=this.getAttribute("src")||"",this.image.alt=this.getAttribute("alt"),this.image.title=this.getAttribute("title")}showFull(){this.setImage(),this.style.display="flex",t("nav").classList.add("hidden"),t("menu-mobile-btn").classList.add("hidden"),document.body.classList.add("hide-y")}hideFull(){this.style.display="none",t("nav").classList.remove("hidden"),t("menu-mobile-btn").classList.remove("hidden"),document.body.classList.remove("hide-y")}attributeChangedCallback(t,e,i){"src"===t&&(i.length>0?this.showFull():this.hideFull())}static get observedAttributes(){return["src"]}}customElements.get("zircus-full-image")||customElements.define("zircus-full-image",e)}();const e=l.product.addToCart,a=l.product.addNotificationText,o=l.product.stockText;class c extends HTMLElement{connectedCallback(){this.priceText=this.querySelector("#product-price-text"),this.sizeInput=this.querySelector("#product-size"),this.imageElement=this.querySelector("#product-image"),this.fullImageElement=this.querySelector("zircus-full-image"),this.quantityInput=this.querySelector("#product-quantity"),this.colorInput=this.querySelector("#product-color"),this.addToCartButton=this.querySelector("#add-to-cart"),this.goToCartButton=this.querySelector("#go-to-cart"),this.goToCartButtonText=this.querySelector("#go-to-cart-qty"),this.productAccent=this.querySelector("#product-accent"),this.stockStatusText=this.querySelector("zircus-in-stock-text"),this.productPrice=this.getAttribute("price"),this._prefix=this.getAttribute("prefix"),this.defaultColor=this.getAttribute("defaultcolor"),this.currentColor=this.colorInput.value,this.item=this.currentItem,this.imageHovered=!1,this.showingFullImage=!1;const t=t=>["a-400.png","b-400.png","a-1920.jpg"].forEach((e=>r(`/assets/img/products/masked/${this._prefix}-${t}-${e}`)));for(const e of this.colorInput.children)t(e.value),e.value===this.defaultColor&&(e.setAttribute("selected",!0),this.productAccent.classList.add(`${e.value}-before`),this.currentColor=e.value);this.updateStatus(),this.updateCartBtnQty(),this.colorInput.addEventListener("change",(()=>{this.setImage("sm_a"),this.updateStatus()})),this.quantityInput.addEventListener("input",(()=>{const t=this.currentItem.quantity;Number(this.quantityInput.value)>t&&(this.quantityInput.value=t),this.priceText.textContent="$"+Number(this.quantityInput.value)*Number(this.productPrice)})),this.sizeInput.addEventListener("input",(()=>this.updateStatus())),this.imageElement.addEventListener("pointerover",(()=>this.handleHoverImage())),this.imageElement.addEventListener("pointerleave",(()=>this.handleHoverImage())),this.imageElement.addEventListener("click",(()=>this.fullImageElement.setAttribute("src",this.currentItem.images.lg_a))),this.fullImageElement.addEventListener("click",(()=>this.fullImageElement.setAttribute("src",""))),this.addToCartButton.addEventListener("click",(()=>this.handleAddToCart())),this.goToCartButton.addEventListener("click",(()=>location.assign(d({en:"/cart",fr:"/fr/panier"})))),i.addHook({hook:()=>this.updateStatus(),key:"inv"}),i.addHook({hook:()=>this.updateCartBtnQty(),key:"cart"})}get currentItem(){return i.inv.find((t=>t.type===`${this._prefix}-${this.colorInput.value}-${this.sizeInput.value}`))}setImage(t){this.currentItem&&(this.imageElement.src=this.currentItem.images[t])}handleHoverImage(){return this.imageHovered=!this.imageHovered,this.imageHovered?this.setImage("sm_b"):this.setImage("sm_a")}updatePrice(){this.priceText.textContent="$"+Number(this.productPrice)*Number(this.quantityInput.value)}createNotificationSuccess(){const t=new s("img","notification__image",{src:this.currentItem.images.sm_a,alt:this.currentItem.name}),e=new s("a","notification__text",{href:d({en:"/cart",fr:"/fr/panier"}),title:d({en:"Go to cart",fr:"Aller au panier"})}).addChild(d(a(this.currentItem)));return{content:[t.render(),e.render()]}}createNotificationFailure(){const t=new s("span",["notification__prefix","red"]).addChild("!"),e=new s("p",["notification__text"]).addChild(d({en:"Unable to add to cart - not enough stock",fr:"Impossible d'ajouter au panier, pas assez de stock"}));return{content:[t.render(),e.render()]}}handleAddToCart(){if(this.currentItem.quantity-Number(this.quantityInput.value)<0||!this.currentItem.quantity)return;const t=i.cart.find((t=>t.type==this.currentItem.type)),e=i.inv.find((t=>t.type===this.currentItem.type));if(t){if(!(t.quantity+Number(this.quantityInput.value)<=e.quantity))return i.notify(this.createNotificationFailure());this.updateCartItem()}else this.addNewCartItem();i.notify(this.createNotificationSuccess()),this.addToCartButton.blur()}updateCartItem(){const t=t=>({...t,quantity:t.quantity+Number(this.quantityInput.value)});return i.cart=e=>e.map((e=>e.type===this.currentItem.type?t(e):e))}addNewCartItem(){return i.cart=t=>t.concat({...this.currentItem,quantity:Number(this.quantityInput.value)})}updateCartBtnQty(){const t=i.cart.reduce(((t,e)=>t+e.quantity),0);this.goToCartButtonText.textContent=""+(t>0?`(${t})`:"")}outOfStock(){this.quantityInput.setAttribute("disabled",!0),this.addToCartButton.setAttribute("disabled",!0),this.addToCartButton.textContent=d(e)[0]}inStock(){this.currentItem.quantity<Number(this.quantityInput.value)&&(this.quantityInput.value=this.currentItem.quantity),this.quantityInput.removeAttribute("disabled"),this.addToCartButton.removeAttribute("disabled"),this.addToCartButton.textContent=d(e)[1]}updateStatus({inv:t,currentItem:e}=i){t&&(e&&(this.sizeInput.value=e.size,this.colorInput.value=e.color,i.currentItem=null),n(this.productAccent,`${this.currentColor}-before`,`${this.colorInput.value}-before`),this.currentColor=this.colorInput.value,this.stockStatusText.setAttribute("quantity",this.currentItem?.quantity),this.stockStatusText.setAttribute("text",d(o(this.currentItem?.quantity))),this.currentItem&&0!==this.currentItem.quantity?this.inStock():this.outOfStock(),this.setImage("sm_a"),this.updatePrice())}}customElements.get("zircus-product")||customElements.define("zircus-product",c)}(),function(){const n=l.checkout.formText;class a extends HTMLElement{connectedCallback(){0===i.cart.length&&location.assign("/"),this.formName=this.querySelector("#checkout-name"),this.formEmail=this.querySelector("#checkout-email"),this.formStreetAddress=this.querySelector("#checkout-street"),this.formCity=this.querySelector("#checkout-city"),this.formState=this.querySelector("#checkout-state"),this.formStateLabel=this.querySelector("#checkout-state-text"),this.formCountry=this.querySelector("#checkout-country"),this.formZip=this.querySelector("#checkout-zip"),this.formZipLabel=this.querySelector("#checkout-zip-text"),this.formElement=this.querySelector("#checkout-form"),this.checkoutSubtotal=this.querySelector("#checkout-subtotal"),this.checkoutTax=this.querySelector("#checkout-tax"),this.checkoutTotal=this.querySelector("#checkout-total"),this.productTemplate=this.querySelector("#checkout-product-template"),this.productList=this.querySelector("#checkout-products"),this.placeOrderButton=this.querySelector("#place-order"),function(s){const{formName:n,formEmail:a,formStreetAddress:r,formCity:o,formCountry:u,formState:l,formZip:h,formElement:p}=s;class f extends HTMLElement{constructor(){super(),this._isLoaded=!1}connectedCallback(){this.cardError=this.querySelector("#card-error"),this.payButton=this.querySelector("#pay-button"),this.buttonText=this.querySelector("#pay-button-text"),this.spinner=this.querySelector("#spinner"),this.paymentPrice=this.querySelector("#payment-price"),this.resultMessage=this.querySelector("#result-message"),this.paymentForm=this.querySelector("#stripe-payment-form"),this.cancelButton=this.querySelector("#cancel"),p.addEventListener("submit",(t=>{t.preventDefault(),this.createPaymentIntent()})),this.cancelButton.addEventListener("click",(()=>this.showModal(!1)))}set isLoaded(t){this._isLoaded=t,this.#handleLoading()}get isLoaded(){return this._isLoaded}#handleLoading=()=>{this.isLoaded?(this.payButton.disabled=!1,this.spinner.classList.add("hidden"),this.buttonText.classList.remove("hidden")):(this.payButton.disabled=!0,this.spinner.classList.remove("hidden"),this.buttonText.classList.add("hidden"))};#showError(t){this.isLoaded=!1,this.cardError.textContent=t,setTimeout((()=>{this.cardError.textContent=""}),4e3)}showModal(e){this.isLoaded=!1,e?(document.body.classList.add("hide-y"),t("blur").classList.add("blur"),this.classList.add("show-modal"),this.payButton.disabled=!0,this.paymentPrice.textContent=""):(document.body.classList.remove("hide-y"),t("blur").classList.remove("blur"),this.classList.remove("show-modal"),0===i.cart.length&&location.assign(d({en:"/thanks",fr:"/fr/merci"})))}async createPaymentIntent(){this.showModal(!0),this.isLoaded=!1;const t={lang:c(),update:i.secret,name:n.value,email:a.value,streetAddress:r.value,city:o.value,country:u.value,state:l.value,zip:h.value,items:i.cart.map((t=>({images:t.images,type:t.type,prefix:t.prefix,size:t.size,name:t.name,color:t.color,quantity:t.quantity})))};fetch(`${e}/orders/create-payment-intent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((t=>t.json())).then((t=>{i.secret=t.clientSecret,i.order={id:t.id,name:t.name,email:t.email},this.paymentPrice.textContent=`$${t.total.toFixed(2)}`,this.loadStripe(t),this.isLoaded=!0}))}loadStripe(t){if(this.isLoaded)return;this.isLoaded=!0;const e=m.elements().create("card",{style:{base:{color:"#211b22",fontFamily:"Nunito, sans-serif",fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#8b808f"}},invalid:{fontFamily:"Nunito, sans-serif",color:"#8f3342",iconColor:"#8f3342"}}});e.mount("#card-element"),e.on("change",(t=>{this.payButton.disabled=t.empty,this.cardError.textContent=t.error?t.error.message:""})),this.paymentForm.addEventListener("submit",(i=>{i.preventDefault(),this.payWithCard(m,e,t.clientSecret)}))}payWithCard(t,e,i){this.isLoaded=!1,t.confirmCardPayment(i,{payment_method:{card:e}}).then((t=>t.error?this.#showError(t.error.message):this.orderComplete()))}orderComplete(){this.isLoaded=!0,i.cart=()=>[],i.secret=null,this.resultMessage.classList.remove("hidden"),this.payButton.disabled=!0,this.payButton.textContent="",this.cancelButton.textContent=d({en:"finish",fr:"complétez"}),this.cancelButton.classList.replace("btn__secondary","btn__primary")}}customElements.get("zircus-stripe")||customElements.define("zircus-stripe",f)}({formName:this.formName,formEmail:this.formEmail,formStreetAddress:this.formStreetAddress,formCity:this.formCity,formState:this.formState,formCountry:this.formCountry,formZip:this.formZip,formElement:this.formElement}),this.setTotals(),this.renderCartItems(),this.populateSelects(this.formCountry,Object.keys(i.countries),(t=>t)),this.handleCountry(),this.formCountry.addEventListener("input",(()=>this.handleCountry())),this.formState.addEventListener("input",(()=>this.setTotals())),this.formZip.addEventListener("input",(t=>{t.target.value=this.normalizeZip(t.target.value,this.formCountry.value)}))}setTotals(){const t=i.cart.reduce(((t,e)=>t+e.price*e.quantity),0),e=t*((t,e)=>{if("Canada"!==t)return.05;switch(e){case"New Brunswick":case"Newfoundland and Labrador":case"Nova Scotia":case"Prince Edward Island":return.15;case"Ontario":return.13;default:return.05}})(this.formCountry.value,this.formState.value),s=t+e;this.checkoutSubtotal.textContent=`$${t.toFixed(2)}`,this.checkoutTax.textContent=`$${e.toFixed(2)}`,this.checkoutTotal.textContent=`$${s.toFixed(2)}`}renderCartItems(){const t=new DocumentFragment;i.cart.forEach((e=>t.appendChild(h({item:e,productTemplate:this.productTemplate})))),this.productList.appendChild(t)}populateSelects(t,e=[],i){t.textContent="",e.forEach((e=>{t.appendChild(new s("option",null,{value:i(e)}).addChild(i(e)).render())}))}handleCountry(){const t=this.formCountry.value;this.formState.textContent="",this.formZip.value="",this.populateSelects(this.formState,i.countries[t].states,(t=>t.name)),this.formStateLabel.textContent=n[t][c()][0],this.formZipLabel.textContent=n[t][c()][1],this.formZip.setAttribute("pattern","Canada"===t?p.source:f.source),this.formZip.setAttribute("maxlength","Canada"===t?"7":"10"),this.formZip.setAttribute("size","Canada"===t?"7":"10"),this.setTotals()}normalizeZip(t){return t=t.toUpperCase(),"Canada"===this.formCountry.value?6===t.length&&p.test(t)?t.substring(0,3)+" "+t.substring(3,6):t:6===t.length&&"-"!==t[5]?t.substring(0,5):t}}customElements.get("zircus-payment")||customElements.define("zircus-payment",a)}(),function(){class t extends HTMLElement{connectedCallback(){this.checkoutButton=this.querySelector("#cart-checkout"),this.subtotalText=this.querySelector("#cart-subtotal"),this.cartProductsList=this.querySelector("#cart-products"),this.productTemplate=this.querySelector("#cart-product-template"),this.emptyCartPlaceholder=this.querySelector("#cart-products-none"),this.renderCartProducts(),this.checkoutButton.addEventListener("click",(()=>{i.cart.length>0&&location.assign(d({en:"/checkout",fr:"/fr/la-caisse"}))}))}enableButtons(){return i.cart.length>0?this.checkoutButton.disabled=!1:this.checkoutButton.disabled=!0}updateSubtotal(){this.subtotalText.textContent=`$${i.cart.reduce(((t,e)=>t+e.price*e.quantity),0).toFixed(2)}`,this.enableButtons()}renderCartProducts(){if(!i.cart.length)return this.emptyCartPlaceholder.style.display="block",this.updateSubtotal();this.emptyCartPlaceholder.style.display="none";const t=new DocumentFragment;return i.cart.forEach((e=>t.appendChild(h({item:e,productTemplate:this.productTemplate,updateSubtotal:()=>this.updateSubtotal(),renderCartProducts:()=>this.renderCartProducts(),withActions:!0})))),this.cartProductsList.appendChild(t),this.updateSubtotal()}}customElements.get("zircus-cart")||customElements.define("zircus-cart",t)}(),g(),function(){class t extends HTMLElement{connectedCallback(){this.button=new s("button",["skip-to-content","small-spaced-bold"]).addChild(this.getAttribute("text")).event("click",this.focused),this.appendChild(this.button.render())}focused(){document.getElementById("main-content").focus()}}customElements.get("zircus-skip-to-content")||customElements.define("zircus-skip-to-content",t)}(),function(){class t extends HTMLElement{constructor(){super(),this._hidden=!0,this.classList.add("nav_mobile"),this.cartLink=this.querySelector("#cart-link-mobile"),this.list=this.querySelector("#menu-mobile-list"),this.list.addEventListener("click",(()=>this.hide())),this.button=this.querySelector("#menu-mobile-btn"),this.button.addEventListener("click",(()=>this._hidden?this.show():this.hide())),this.updateCartLink([this.cartLink]),i.addHook({hook:()=>this.updateCartLink([this.cartLink]),key:"cart"})}hide(){this._hidden=!0,this.list.classList.add("hide"),document.body.classList.remove("hide-y")}show(){this._hidden=!1,this.list.classList.remove("hide"),document.body.classList.add("hide-y")}}Object.assign(t.prototype,y()),customElements.get("nav-mobile")||customElements.define("nav-mobile",t)}(),function(){class t extends HTMLElement{#MIN_SCROLL=400;constructor(){super(),this.button=this.querySelector("#to-top-button"),this.buttonHidden=!0,this.buttonFocused=!1,this.throttled=!1}connectedCallback(){this.button.addEventListener("click",(()=>{window.scroll({top:0}),this.button.blur()})),document.addEventListener("scroll",this.scrollHandler())}show(){this.button.classList.add("show"),this.buttonHidden=!1,this.throttled=!1}hide(){this.button.classList.remove("show"),this.buttonHidden=!0,this.throttled=!1}scrollHandler(){return()=>this.throttled?this.throttled=!0:setTimeout((()=>{const t=window.scrollY>this.#MIN_SCROLL;return this.buttonFocused&&this.buttonHidden||t&&this.buttonHidden?this.show():t||this.buttonHidden?void 0:this.hide()}),100)}}customElements.get("zircus-to-top-button")||customElements.define("zircus-to-top-button",t)}(),(()=>{class t extends HTMLElement{connectedCallback(){this._images=new Array(Number(this.getAttribute("num-images"))).fill("").map(((t,e)=>`${this.getAttribute("image-path")}${e}.jpg`)),this._images.forEach((t=>r(t))),this._currentImage=1,this._imageEl=new s("img","section__hero_image",{src:this._images[this._currentImage],alt:this.getAttribute("alt"),title:this.getAttribute("title")}),this._roundedBottom=new s("div",["bg-light","rounded-big-top","absolute","b-0","l-0"]),this.appendChild(this._imageEl.render()),this.appendChild(this._roundedBottom.render()),this.classList.add("section__hero"),setInterval((()=>{this._imageEl.src=this._images[this.getCurrentImage()]}),4500)}getCurrentImage(){return this._currentImage===this._images.length-1?this._currentImage=0:++this._currentImage}}customElements.get("zircus-hero-image")||customElements.define("zircus-hero-image",t)})(),function(){const e=t("order-id");if(!e)return;i.order||location.assign("/");const s=t("user-name"),n=t("user-email"),a=i.order;e.textContent=a.id,s.textContent=a.name.split(" ")[0],n.textContent=a.email}(),function(){class t extends HTMLElement{connectedCallback(){this._form=this.querySelector("#contact-form"),this._nameInput=this.querySelector("#contact-name"),this._emailInput=this.querySelector("#contact-email"),this._sendButton=this.querySelector("#contact-button"),this._messageText=this.querySelector("#contact-message");const t=[this._nameInput,this._emailInput,this._sendButton,this._messageText];this._form.addEventListener("submit",(i=>{i.preventDefault();const s={name:this._nameInput.value,email:this._emailInput.value,message:this._messageText.value};t.forEach((t=>{t.value="",t.disabled=!0})),fetch(`${e}/message`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then((t=>t.json())).then((t=>{return t.error?(e=t.error,b({heading:C[c()].error[0],content:e,ok:{text:C[c()].error[1],title:C[c()].error[2],action:t=>t()}})):(t=>b({heading:C[c()].default[0],content:C[c()].message(t.name,t.email),ok:{text:C[c()].default[1],title:C[c()].default[2],action:t=>t()}}))(t);var e})).then((()=>t.forEach((t=>t.disabled=!1)))).catch((t=>console.log(t)))}))}}customElements.get("zircus-contact-form")||customElements.define("zircus-contact-form",t)}(),function(){class t extends HTMLElement{attributeChangedCallback(t,e,n){const a=i.currentNotification,r=this.querySelector("#notification-content"),o=this.querySelector("#notification"),c=this.querySelector("#notification-close");if(r.textContent="","show"===t&&"false"===n)return o.classList.add("hidden");if("show"===t&&"true"===n){if("string"==typeof a.content){const t=new s("p","notification__text").addChild(a.content);r.appendChild(t.render())}else Array.isArray(a.content)?a.content.forEach((t=>r.append(t))):r.appendChild(a.content);o.classList.remove("hidden")}c.addEventListener("click",(()=>{this.setAttribute("show","false"),i.currentNotification=null,clearTimeout(a.id)}))}static get observedAttributes(){return["show"]}}customElements.get("zircus-notification")||customElements.define("zircus-notification",t);const e=document.querySelector("zircus-notification");if(!e)return;const n=()=>{e.setAttribute("show","false"),i.currentNotification=null};i.setNotify((({content:t,time:s=4e3})=>{i.currentNotification&&clearTimeout(i.currentNotification.id),i.currentNotification={content:t,id:setTimeout(n,s)},e.setAttribute("show","true"),e.addEventListener("mouseenter",(()=>clearTimeout(i.currentNotification.id))),e.addEventListener("mouseleave",(()=>setTimeout(n,s-s/2)))}))}(),function(){class t extends HTMLElement{connectedCallback(){this.tagLines=this.getAttribute("taglines").split("|");const t=this.tagLines[Math.floor(Math.random()*this.tagLines.length)],e=new s("h1","home__heading");e.addChild(new s("span").addChild(t)),e.addChild(new s("span","teal").addChild(".")),this.classList.add("home__heading_container"),this.appendChild(e.render())}}customElements.get("zircus-tag-line")||customElements.define("zircus-tag-line",t)}(),function(){const t=navigator.language,e=location.pathname.includes(`/${t}`),n=!!localStorage.getItem("notified");!/^fr\b/.test(t)||e||n||(t=>{const e=l.redirect[t],n=new s("a","notification__text",{href:`/${t}`,title:e}).addChild(e),a=new s("span",["notification__prefix","green"]).addChild("?");i.notify({color:"gray",time:8e3,content:[a.render(),n.render()]}),localStorage.setItem("notified",JSON.stringify(!0))})("fr")}()}();
